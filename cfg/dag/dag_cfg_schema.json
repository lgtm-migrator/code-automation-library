{
  "$schema": "http://json-schema.org/draft/2019-09/schema",
  "$id": "dag_cfg_schema.json",
  "type": "object",
  "default": {},
  "title": "Root Schema",
  "required": [
      "name",
      "dag",
      "args",
      "properties",
      "imports",
      "tasks"
  ],
  "properties": {
      "name": {
          "type": "string",
          "default": "",
          "title": "The name if the DAG",
          "examples": [
              "GCP_SPINE_OFFER"
          ]
      },
      "dag": {
          "type": "object",
          "default": {},
          "title": "Defines the DAG parameters",
          "required": [
              "description",
              "tags"
          ],
          "properties": {
              "description": {
                  "type": "string",
                  "default": "",
                  "title": "The description Schema",
                  "examples": [
                      "Populates portfolio offer tables uk_pub_customer_spine_offer_is"
                  ]
              },
              "tags": {
                  "type": "array",
                  "default": [],
                  "title": "The tags Schema",
                  "items": {
                      "type": "string",
                      "title": "A Schema",
                      "examples": [
                          "offer",
                          "customer"
                      ]
                  },
                  "examples": [
                      ["offer",
                          "customer"
                      ]
                  ]
              }
          },
          "examples": [{
              "description": "Populates portfolio offer tables uk_pub_customer_spine_offer_is",
              "tags": [
                  "offer",
                  "customer"
              ]
          }]
      },
      "args": {
          "type": "object",
          "default": {},
          "title": "The args Schema",
          "required": [
              "owner",
              "email"
          ],
          "properties": {
              "owner": {
                  "type": "string",
                  "default": "",
                  "title": "The owner Schema",
                  "examples": [
                      "customerbtprod"
                  ]
              },
              "email": {
                  "type": "array",
                  "default": [],
                  "title": "The email Schema",
                  "items": {
                      "type": "string",
                      "default": "",
                      "title": "A Schema",
                      "examples": [
                          "sean.conkie@sky.uk"
                      ]
                  },
                  "examples": [
                      [
                          "sean.conkie@sky.uk"]
                  ]
              }
          },
          "examples": [{
              "owner": "customerbtprod",
              "email": [
                  "sean.conkie@sky.uk"
              ]
          }]
      },
      "properties": {
          "type": "object",
          "default": {},
          "title": "The properties Schema",
          "required": [
              "dataset_staging",
              "dataset_publish"
          ],
          "properties": {
              "dataset_staging": {
                  "type": "string",
                  "default": "",
                  "title": "The dataset_staging Schema",
                  "examples": [
                      "uk_pre_customer_spine_offer_is"
                  ]
              },
              "dataset_publish": {
                  "type": "string",
                  "default": "",
                  "title": "The dataset_publish Schema",
                  "examples": [
                      "uk_pub_customer_spine_offer_is"
                  ]
              }
          },
          "examples": [{
              "dataset_staging": "uk_pre_customer_spine_offer_is",
              "dataset_publish": "uk_pub_customer_spine_offer_is"
          }]
      },
      "imports": {
          "type": "array",
          "default": [],
          "title": "The imports Schema",
          "items": {},
          "examples": [
              []
          ]
      },
      "tasks": {
          "type": "array",
          "default": [],
          "title": "The tasks Schema",
          "items": {
              "type": "object",
              "title": "A Schema",
              "required": [
                  "task_id",
                  "operator",
                  "parameters",
                  "dependencies"
              ],
              "properties": {
                  "task_id": {
                      "type": "string",
                      "title": "The task_id Schema",
                      "examples": [
                          "dim_offer_type",
                          "td_offer_status_core",
                          "td_offer_priceable_unit_core",
                          "td_offer_priceable_unit_soip",
                          "truncate_dim_offer_priceable_unit",
                          "dim_offer_priceable_unit_core",
                          "dim_offer_priceable_unit_soip",
                          "td_offer_discount_core_pt1",
                          "td_offer_discount_core_pt2",
                          "td_offer_discount_soip",
                          "dim_offer_discount",
                          "td_offer_status_soip",
                          "dim_offer_status"
                      ]
                  },
                  "operator": {
                      "type": "string",
                      "title": "The operator Schema",
                      "examples": [
                          "CreateTable",
                          "BigQueryOperator"
                      ]
                  },
                  "parameters": {
                      "type": "object",
                      "title": "The parameters Schema",
                      "required": [
                          "destination_table",
                          "target_type",
                          "driving_table",
                          "joins",
                          "source_to_target",
                          "where",
                          "write_disposition",
                          "destination_dataset",
                          "history",
                          "sql",
                          "destination_dataset_table",
                          "create_disposition",
                          "allow_large_results",
                          "use_legacy_sql"
                      ],
                      "properties": {
                          "destination_table": {
                              "type": "string",
                              "title": "The destination_table Schema",
                              "examples": [
                                  "dim_offer_type",
                                  "td_offer_status_core",
                                  "td_offer_priceable_unit_core",
                                  "td_offer_priceable_unit_soip",
                                  "dim_offer_priceable_unit"
                              ]
                          },
                          "target_type": {
                              "type": "integer",
                              "title": "The target_type Schema",
                              "examples": [
                                  1,
                                  2
                              ]
                          },
                          "driving_table": {
                              "type": "string",
                              "title": "The driving_table Schema",
                              "examples": [
                                  "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                                  "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                                  "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                                  "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                                  "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip"
                              ]
                          },
                          "joins": {
                              "type": "array",
                              "title": "The joins Schema",
                              "items": {
                                  "type": "object",
                                  "title": "A Schema",
                                  "required": [
                                      "right",
                                      "on"
                                  ],
                                  "properties": {
                                      "right": {
                                          "type": "string",
                                          "title": "The right Schema",
                                          "examples": [
                                              "uk_tds_refdata_eod_is.cc_refdata_bsboffertype",
                                              "uk_tds_chordiant_eod_is.cc_chordiant_picklist"
                                          ]
                                      },
                                      "on": {
                                          "type": "array",
                                          "title": "The on Schema",
                                          "items": {
                                              "type": "object",
                                              "title": "A Schema",
                                              "required": [
                                                  "operator",
                                                  "fields"
                                              ],
                                              "properties": {
                                                  "operator": {
                                                      "type": "string",
                                                      "title": "The operator Schema",
                                                      "examples": [
                                                          "=",
                                                          "\u003c\u003e"
                                                      ]
                                                  },
                                                  "fields": {
                                                      "type": "array",
                                                      "title": "The fields Schema",
                                                      "items": {
                                                          "type": "string",
                                                          "title": "A Schema",
                                                          "examples": [
                                                              "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype.offertypeid",
                                                              "uk_tds_refdata_eod_is.cc_refdata_bsboffertype.id",
                                                              "uk_tds_refdata_eod_is.cc_refdata_bsboffertype.rdmaction",
                                                              "'D'",
                                                              "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.status",
                                                              "uk_tds_chordiant_eod_is.cc_chordiant_picklist.code",
                                                              "uk_tds_chordiant_eod_is.cc_chordiant_picklist.logically_deleted",
                                                              "0"
                                                          ]
                                                      },
                                                      "examples": [
                                                          ["uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype.offertypeid",
                                                              "uk_tds_refdata_eod_is.cc_refdata_bsboffertype.id"
                                                          ],
                                                          ["uk_tds_refdata_eod_is.cc_refdata_bsboffertype.rdmaction",
                                                              "'D'"
                                                          ],
                                                          ["uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.status",
                                                              "uk_tds_chordiant_eod_is.cc_chordiant_picklist.code"
                                                          ],
                                                          ["uk_tds_chordiant_eod_is.cc_chordiant_picklist.logically_deleted",
                                                              "0"
                                                          ]
                                                      ]
                                                  }
                                              },
                                              "examples": [{
                                                  "operator": "=",
                                                  "fields": [
                                                      "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype.offertypeid",
                                                      "uk_tds_refdata_eod_is.cc_refdata_bsboffertype.id"
                                                  ]
                                              },
                                              {
                                                  "operator": "\u003c\u003e",
                                                  "fields": [
                                                      "uk_tds_refdata_eod_is.cc_refdata_bsboffertype.rdmaction",
                                                      "'D'"
                                                  ]
                                              },
                                              {
                                                  "operator": "=",
                                                  "fields": [
                                                      "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.status",
                                                      "uk_tds_chordiant_eod_is.cc_chordiant_picklist.code"
                                                  ]
                                              },
                                              {
                                                  "operator": "=",
                                                  "fields": [
                                                      "uk_tds_chordiant_eod_is.cc_chordiant_picklist.logically_deleted",
                                                      "0"
                                                  ]
                                              }]
                                          },
                                          "examples": [
                                              [{
                                                  "operator": "=",
                                                  "fields": [
                                                      "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype.offertypeid",
                                                      "uk_tds_refdata_eod_is.cc_refdata_bsboffertype.id"
                                                  ]
                                              },
                                              {
                                                  "operator": "\u003c\u003e",
                                                  "fields": [
                                                      "uk_tds_refdata_eod_is.cc_refdata_bsboffertype.rdmaction",
                                                      "'D'"
                                                  ]
                                              }],
                                              [{
                                                  "operator": "=",
                                                  "fields": [
                                                      "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.status",
                                                      "uk_tds_chordiant_eod_is.cc_chordiant_picklist.code"
                                                  ]
                                              },
                                              {
                                                  "operator": "=",
                                                  "fields": [
                                                      "uk_tds_chordiant_eod_is.cc_chordiant_picklist.logically_deleted",
                                                      "0"
                                                  ]
                                              }]
                                          ]
                                      }
                                  },
                                  "examples": [{
                                      "right": "uk_tds_refdata_eod_is.cc_refdata_bsboffertype",
                                      "on": [{
                                          "operator": "=",
                                          "fields": [
                                              "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype.offertypeid",
                                              "uk_tds_refdata_eod_is.cc_refdata_bsboffertype.id"
                                          ]
                                      },
                                      {
                                          "operator": "\u003c\u003e",
                                          "fields": [
                                              "uk_tds_refdata_eod_is.cc_refdata_bsboffertype.rdmaction",
                                              "'D'"
                                          ]
                                      }]
                                  },
                                  {
                                      "right": "uk_tds_chordiant_eod_is.cc_chordiant_picklist",
                                      "on": [{
                                          "operator": "=",
                                          "fields": [
                                              "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.status",
                                              "uk_tds_chordiant_eod_is.cc_chordiant_picklist.code"
                                          ]
                                      },
                                      {
                                          "operator": "=",
                                          "fields": [
                                              "uk_tds_chordiant_eod_is.cc_chordiant_picklist.logically_deleted",
                                              "0"
                                          ]
                                      }]
                                  }]
                              },
                              "examples": [
                                  [{
                                      "right": "uk_tds_refdata_eod_is.cc_refdata_bsboffertype",
                                      "on": [{
                                          "operator": "=",
                                          "fields": [
                                              "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype.offertypeid",
                                              "uk_tds_refdata_eod_is.cc_refdata_bsboffertype.id"
                                          ]
                                      },
                                      {
                                          "operator": "\u003c\u003e",
                                          "fields": [
                                              "uk_tds_refdata_eod_is.cc_refdata_bsboffertype.rdmaction",
                                              "'D'"
                                          ]
                                      }]
                                  }],
                                  [{
                                      "right": "uk_tds_chordiant_eod_is.cc_chordiant_picklist",
                                      "on": [{
                                          "operator": "=",
                                          "fields": [
                                              "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.status",
                                              "uk_tds_chordiant_eod_is.cc_chordiant_picklist.code"
                                          ]
                                      },
                                      {
                                          "operator": "=",
                                          "fields": [
                                              "uk_tds_chordiant_eod_is.cc_chordiant_picklist.logically_deleted",
                                              "0"
                                          ]
                                      }]
                                  }]
                              ]
                          },
                          "source_to_target": {
                              "type": "array",
                              "title": "The source_to_target Schema",
                              "items": {
                                  "type": "object",
                                  "title": "Defines the source to target transformation for a single target column",
                                  "required": [
                                      "name",
                                      "source_column OR transformation"
                                  ],
                                  "properties": {
                                      "name": {
                                          "type": "string",
                                          "title": "The name of the target column",
                                          "examples": [
                                              "id"
                                          ]
                                      },
                                      "source_name": {
                                          "type": "string",
                                          "title": "The name of the source table",
                                          "examples": [
                                              "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype"
                                          ]
                                      },
                                      "source_column": {
                                          "type": "string",
                                          "title": "The source column name",
                                          "examples": [
                                              "id"
                                          ]
                                      },
                                      "transformation": {
                                          "type": "string",
                                          "title": "deines any transformation to be applied to the column, replaces source_name and source_column",
                                          "examples": [
                                              "current_timestamp()",
                                              "ifnull(uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.statuschangeddate,uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.effective_from_dt)",
                                              "abs(uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit.quotedprice)"
                                          ]
                                      }
                                  },
                                  "examples": [{
                                      "name": "id",
                                      "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                                      "source_column": "id"
                                  }]
                              },
                              "examples": [
                                  [{
                                      "name": "id",
                                      "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                                      "source_column": "id"
                                  }]
                              ]
                          },
                          "where": {
                              "type": "array",
                              "title": "The where Schema",
                              "items": {
                                  "type": "object",
                                  "title": "A Schema",
                                  "required": [
                                      "operator",
                                      "fields"
                                  ],
                                  "properties": {
                                      "operator": {
                                          "type": "string",
                                          "title": "The operator Schema",
                                          "examples": [
                                              "\u003c\u003e",
                                              "="
                                          ]
                                      },
                                      "fields": {
                                          "type": "array",
                                          "title": "The fields Schema",
                                          "items": {
                                              "type": "string",
                                              "title": "A Schema",
                                              "examples": [
                                                  "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype.offertypeid",
                                                  "'D'",
                                                  "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.logically_deleted",
                                                  "0",
                                                  "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit.logically_deleted"
                                              ]
                                          },
                                          "examples": [
                                              ["uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype.offertypeid",
                                                  "'D'"
                                              ],
                                              ["uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.logically_deleted",
                                                  "0"
                                              ],
                                              ["uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit.logically_deleted",
                                                  "0"
                                              ]
                                          ]
                                      }
                                  },
                                  "examples": [{
                                      "operator": "\u003c\u003e",
                                      "fields": [
                                          "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype.offertypeid",
                                          "'D'"
                                      ]
                                  },
                                  {
                                      "operator": "=",
                                      "fields": [
                                          "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.logically_deleted",
                                          "0"
                                      ]
                                  },
                                  {
                                      "operator": "=",
                                      "fields": [
                                          "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit.logically_deleted",
                                          "0"
                                      ]
                                  }]
                              },
                              "examples": [
                                  [{
                                      "operator": "\u003c\u003e",
                                      "fields": [
                                          "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype.offertypeid",
                                          "'D'"
                                      ]
                                  }],
                                  [{
                                      "operator": "=",
                                      "fields": [
                                          "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.logically_deleted",
                                          "0"
                                      ]
                                  }],
                                  [{
                                      "operator": "=",
                                      "fields": [
                                          "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit.logically_deleted",
                                          "0"
                                      ]
                                  }]
                              ]
                          },
                          "write_disposition": {
                              "type": "string",
                              "title": "The write_disposition Schema",
                              "examples": [
                                  "WRITE_TRUNCATE",
                                  "WRITE_APPEND"
                              ]
                          },
                          "destination_dataset": {
                              "type": "string",
                              "title": "The destination_dataset Schema",
                              "examples": [
                                  "uk_pre_customer_spine_offer_is"
                              ]
                          },
                          "history": {
                              "type": "object",
                              "default": {},
                              "title": "The history Schema",
                              "required": [
                                  "partition",
                                  "driving_column",
                                  "order"
                              ],
                              "properties": {
                                  "partition": {
                                      "type": "array",
                                      "default": [],
                                      "title": "The partition Schema",
                                      "items": {
                                          "type": "object",
                                          "default": {},
                                          "title": "A Schema",
                                          "required": [
                                              "name",
                                              "source_name",
                                              "source_column"
                                          ],
                                          "properties": {
                                              "name": {
                                                  "type": "string",
                                                  "default": "",
                                                  "title": "The name Schema",
                                                  "examples": [
                                                      "portfolio_offer_id"
                                                  ]
                                              },
                                              "source_name": {
                                                  "type": "string",
                                                  "default": "",
                                                  "title": "The source_name Schema",
                                                  "examples": [
                                                      "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer"
                                                  ]
                                              },
                                              "source_column": {
                                                  "type": "string",
                                                  "default": "",
                                                  "title": "The source_column Schema",
                                                  "examples": [
                                                      "id"
                                                  ]
                                              }
                                          },
                                          "examples": [{
                                              "name": "portfolio_offer_id",
                                              "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                                              "source_column": "id"
                                          }]
                                      },
                                      "examples": [
                                          [{
                                              "name": "portfolio_offer_id",
                                              "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                                              "source_column": "id"
                                          }]
                                      ]
                                  },
                                  "driving_column": {
                                      "type": "array",
                                      "default": [],
                                      "title": "The driving_column Schema",
                                      "items": {
                                          "type": "object",
                                          "title": "A Schema",
                                          "required": [
                                              "name",
                                              "source_name",
                                              "source_column"
                                          ],
                                          "properties": {
                                              "name": {
                                                  "type": "string",
                                                  "title": "The name Schema",
                                                  "examples": [
                                                      "status_code",
                                                      "reason_code"
                                                  ]
                                              },
                                              "source_name": {
                                                  "type": "string",
                                                  "title": "The source_name Schema",
                                                  "examples": [
                                                      "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer"
                                                  ]
                                              },
                                              "source_column": {
                                                  "type": "string",
                                                  "title": "The source_column Schema",
                                                  "examples": [
                                                      "status",
                                                      "statusreasoncode"
                                                  ]
                                              }
                                          },
                                          "examples": [{
                                              "name": "status_code",
                                              "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                                              "source_column": "status"
                                          },
                                          {
                                              "name": "reason_code",
                                              "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                                              "source_column": "statusreasoncode"
                                          }]
                                      },
                                      "examples": [
                                          [{
                                              "name": "status_code",
                                              "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                                              "source_column": "status"
                                          },
                                          {
                                              "name": "reason_code",
                                              "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                                              "source_column": "statusreasoncode"
                                          }]
                                      ]
                                  },
                                  "order": {
                                      "type": "array",
                                      "default": [],
                                      "title": "The order Schema",
                                      "items": {
                                          "type": "object",
                                          "title": "A Schema",
                                          "required": [
                                              "name",
                                              "transformation",
                                              "source_name",
                                              "source_column"
                                          ],
                                          "properties": {
                                              "name": {
                                                  "type": "string",
                                                  "title": "The name Schema",
                                                  "examples": [
                                                      "effective_from_dt",
                                                      "effective_from_dt_csn_seq",
                                                      "effective_from_dt_seq"
                                                  ]
                                              },
                                              "transformation": {
                                                  "type": "string",
                                                  "default": "",
                                                  "title": "The transformation Schema",
                                                  "examples": [
                                                      "ifnull(uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.statuschangeddate,uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.effective_from_dt)"
                                                  ]
                                              },
                                              "source_name": {
                                                  "type": "string",
                                                  "title": "The source_name Schema",
                                                  "examples": [
                                                      "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer"
                                                  ]
                                              },
                                              "source_column": {
                                                  "type": "string",
                                                  "title": "The source_column Schema",
                                                  "examples": [
                                                      "effective_from_dt_csn_seq",
                                                      "effective_from_dt_seq"
                                                  ]
                                              }
                                          },
                                          "examples": [{
                                              "name": "effective_from_dt",
                                              "transformation": "ifnull(uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.statuschangeddate,uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.effective_from_dt)"
                                          },
                                          {
                                              "name": "effective_from_dt_csn_seq",
                                              "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                                              "source_column": "effective_from_dt_csn_seq"
                                          },
                                          {
                                              "name": "effective_from_dt_seq",
                                              "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                                              "source_column": "effective_from_dt_seq"
                                          }]
                                      },
                                      "examples": [
                                          [{
                                              "name": "effective_from_dt",
                                              "transformation": "ifnull(uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.statuschangeddate,uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.effective_from_dt)"
                                          },
                                          {
                                              "name": "effective_from_dt_csn_seq",
                                              "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                                              "source_column": "effective_from_dt_csn_seq"
                                          },
                                          {
                                              "name": "effective_from_dt_seq",
                                              "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                                              "source_column": "effective_from_dt_seq"
                                          }]
                                      ]
                                  }
                              },
                              "examples": [{
                                  "partition": [{
                                      "name": "portfolio_offer_id",
                                      "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                                      "source_column": "id"
                                  }],
                                  "driving_column": [{
                                      "name": "status_code",
                                      "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                                      "source_column": "status"
                                  },
                                  {
                                      "name": "reason_code",
                                      "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                                      "source_column": "statusreasoncode"
                                  }],
                                  "order": [{
                                      "name": "effective_from_dt",
                                      "transformation": "ifnull(uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.statuschangeddate,uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.effective_from_dt)"
                                  },
                                  {
                                      "name": "effective_from_dt_csn_seq",
                                      "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                                      "source_column": "effective_from_dt_csn_seq"
                                  },
                                  {
                                      "name": "effective_from_dt_seq",
                                      "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                                      "source_column": "effective_from_dt_seq"
                                  }]
                              }]
                          },
                          "sql": {
                              "type": "string",
                              "title": "The sql Schema",
                              "examples": [
                                  "sql/spine_offer_td_offer_priceable_unit_soip.sql",
                                  "truncate table uk_pub_customer_spine_offer_is.dim_offer_priceable_unit;",
                                  "sql/spine_offer_td_offer_discount_1.sql",
                                  "sql/spine_offer_td_offer_discount_2.sql",
                                  "sql/spine_offer_td_offer_discount_soip.sql",
                                  "sql/spine_offer_dim_offer_discount.sql",
                                  "sql/spine_offer_td_offer_status_soip.sql",
                                  "sql/spine_offer_dim_offer_status.sql"
                              ]
                          },
                          "destination_dataset_table": {
                              "type": "string",
                              "title": "The destination_dataset_table Schema",
                              "examples": [
                                  ""
                              ]
                          },
                          "create_disposition": {
                              "type": "string",
                              "title": "The create_disposition Schema",
                              "examples": [
                                  "CREATE_IF_NEEDED"
                              ]
                          },
                          "allow_large_results": {
                              "type": "boolean",
                              "title": "The allow_large_results Schema",
                              "examples": [
                                  true
                              ]
                          },
                          "use_legacy_sql": {
                              "type": "boolean",
                              "title": "The use_legacy_sql Schema",
                              "examples": [
                                  false
                              ]
                          }
                      },
                      "examples": [{
                          "destination_table": "dim_offer_type",
                          "target_type": 1,
                          "driving_table": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                          "joins": [{
                              "right": "uk_tds_refdata_eod_is.cc_refdata_bsboffertype",
                              "on": [{
                                  "operator": "=",
                                  "fields": [
                                      "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype.offertypeid",
                                      "uk_tds_refdata_eod_is.cc_refdata_bsboffertype.id"
                                  ]
                              },
                              {
                                  "operator": "\u003c\u003e",
                                  "fields": [
                                      "uk_tds_refdata_eod_is.cc_refdata_bsboffertype.rdmaction",
                                      "'D'"
                                  ]
                              }]
                          }],
                          "source_to_target": [{
                              "name": "id",
                              "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                              "source_column": "id"
                          },
                          {
                              "name": "dw_last_modified_dt",
                              "transformation": "current_timestamp()"
                          },
                          {
                              "name": "offer_detail_id",
                              "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                              "source_column": "offerid"
                          },
                          {
                              "name": "offer_type_id",
                              "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                              "source_column": "offertypeid"
                          },
                          {
                              "name": "offer_type_id",
                              "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                              "source_column": "offertypeid"
                          },
                          {
                              "name": "created_dt",
                              "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                              "source_column": "created"
                          },
                          {
                              "name": "created_by_id",
                              "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                              "source_column": "createdby"
                          },
                          {
                              "name": "last_modified_dt",
                              "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                              "source_column": "lastupdate"
                          },
                          {
                              "name": "last_modified_by_id",
                              "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                              "source_column": "updatedby"
                          },
                          {
                              "name": "code",
                              "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertype",
                              "source_column": "code"
                          },
                          {
                              "name": "description",
                              "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertype",
                              "source_column": "description"
                          }],
                          "where": [{
                              "operator": "\u003c\u003e",
                              "fields": [
                                  "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype.offertypeid",
                                  "'D'"
                              ]
                          }]
                      },
                      {
                          "write_disposition": "WRITE_TRUNCATE",
                          "destination_table": "td_offer_status_core",
                          "destination_dataset": "uk_pre_customer_spine_offer_is",
                          "target_type": 2,
                          "history": {
                              "partition": [{
                                  "name": "portfolio_offer_id",
                                  "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                                  "source_column": "id"
                              }],
                              "driving_column": [{
                                  "name": "status_code",
                                  "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                                  "source_column": "status"
                              },
                              {
                                  "name": "reason_code",
                                  "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                                  "source_column": "statusreasoncode"
                              }],
                              "order": [{
                                  "name": "effective_from_dt",
                                  "transformation": "ifnull(uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.statuschangeddate,uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.effective_from_dt)"
                              },
                              {
                                  "name": "effective_from_dt_csn_seq",
                                  "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                                  "source_column": "effective_from_dt_csn_seq"
                              },
                              {
                                  "name": "effective_from_dt_seq",
                                  "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                                  "source_column": "effective_from_dt_seq"
                              }]
                          },
                          "driving_table": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                          "joins": [{
                              "right": "uk_tds_chordiant_eod_is.cc_chordiant_picklist",
                              "on": [{
                                  "operator": "=",
                                  "fields": [
                                      "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.status",
                                      "uk_tds_chordiant_eod_is.cc_chordiant_picklist.code"
                                  ]
                              },
                              {
                                  "operator": "=",
                                  "fields": [
                                      "uk_tds_chordiant_eod_is.cc_chordiant_picklist.logically_deleted",
                                      "0"
                                  ]
                              }]
                          }],
                          "source_to_target": [{
                              "name": "portfolio_offer_id",
                              "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                              "source_column": "id"
                          },
                          {
                              "name": "dw_last_modified_dt",
                              "transformation": "current_timestamp()"
                          },
                          {
                              "name": "effective_from_dt",
                              "transformation": "ifnull(uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.statuschangeddate,uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.effective_from_dt)"
                          },
                          {
                              "name": "effective_from_dt_csn_seq",
                              "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                              "source_column": "effective_from_dt_csn_seq"
                          },
                          {
                              "name": "effective_from_dt_seq",
                              "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                              "source_column": "effective_from_dt_seq"
                          },
                          {
                              "name": "effective_to_dt",
                              "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                              "source_column": "statuschangeddate"
                          },
                          {
                              "name": "status_code",
                              "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                              "source_column": "status"
                          },
                          {
                              "name": "status",
                              "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_picklist",
                              "source_column": "codedesc"
                          },
                          {
                              "name": "reason_code",
                              "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                              "source_column": "statusreasoncode"
                          },
                          {
                              "name": "reason",
                              "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_picklist",
                              "source_column": "codedesc"
                          }],
                          "where": [{
                              "operator": "=",
                              "fields": [
                                  "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.logically_deleted",
                                  "0"
                              ]
                          }]
                      },
                      {
                          "write_disposition": "WRITE_TRUNCATE",
                          "destination_table": "td_offer_priceable_unit_core",
                          "destination_dataset": "uk_pre_customer_spine_offer_is",
                          "target_type": 1,
                          "driving_table": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                          "source_to_target": [{
                              "name": "id",
                              "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                              "source_column": "id"
                          },
                          {
                              "name": "dw_last_modified_dt",
                              "transformation": "current_timestamp()"
                          },
                          {
                              "name": "created_dt",
                              "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                              "source_column": "created"
                          },
                          {
                              "name": "created_by_id",
                              "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                              "source_column": "createdby"
                          },
                          {
                              "name": "last_modified_dt",
                              "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                              "source_column": "lastupdate"
                          },
                          {
                              "name": "last_modified_by_id",
                              "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                              "source_column": "updatedby"
                          },
                          {
                              "name": "portfolio_offer_id",
                              "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                              "source_column": "portfolioofferid"
                          },
                          {
                              "name": "discounted_priceable_unit_id",
                              "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                              "source_column": "discountedpriceableunitid"
                          },
                          {
                              "name": "effective_dt",
                              "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                              "source_column": "effectivedate"
                          },
                          {
                              "name": "end_dt",
                              "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                              "source_column": "endate"
                          },
                          {
                              "name": "quoted_discount",
                              "transformation": "abs(uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit.quotedprice)"
                          }],
                          "where": [{
                              "operator": "=",
                              "fields": [
                                  "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit.logically_deleted",
                                  "0"
                              ]
                          }]
                      },
                      {
                          "sql": "sql/spine_offer_td_offer_priceable_unit_soip.sql",
                          "destination_table": "td_offer_priceable_unit_soip",
                          "destination_dataset": "uk_pre_customer_spine_offer_is"
                      },
                      {
                          "sql": "truncate table uk_pub_customer_spine_offer_is.dim_offer_priceable_unit;",
                          "destination_table": "dim_offer_priceable_unit"
                      },
                      {
                          "write_disposition": "WRITE_APPEND",
                          "destination_table": "dim_offer_priceable_unit",
                          "target_type": 1,
                          "driving_table": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                          "source_to_target": [{
                              "name": "id",
                              "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                              "source_column": "id"
                          },
                          {
                              "name": "dw_last_modified_dt",
                              "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                              "source_column": "dw_last_modified_dt"
                          },
                          {
                              "name": "created_dt",
                              "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                              "source_column": "created_dt"
                          },
                          {
                              "name": "created_by_id",
                              "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                              "source_column": "created_by_id"
                          },
                          {
                              "name": "last_modified_dt",
                              "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                              "source_column": "last_modified_dt"
                          },
                          {
                              "name": "last_modified_by_id",
                              "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                              "source_column": "last_modified_by_id"
                          },
                          {
                              "name": "portfolio_offer_id",
                              "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                              "source_column": "portfolio_offer_id"
                          },
                          {
                              "name": "discounted_priceable_unit_id",
                              "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                              "source_column": "discounted_priceable_unit_id"
                          },
                          {
                              "name": "effective_dt",
                              "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                              "source_column": "effective_dt"
                          },
                          {
                              "name": "end_dt",
                              "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                              "source_column": "end_dt"
                          },
                          {
                              "name": "quoted_discount",
                              "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                              "source_column": "quoted_discount"
                          }]
                      },
                      {
                          "write_disposition": "WRITE_APPEND",
                          "destination_table": "dim_offer_priceable_unit",
                          "target_type": 1,
                          "driving_table": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                          "source_to_target": [{
                              "name": "id",
                              "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                              "source_column": "id"
                          },
                          {
                              "name": "dw_last_modified_dt",
                              "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                              "source_column": "dw_last_modified_dt"
                          },
                          {
                              "name": "created_dt",
                              "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                              "source_column": "created_dt"
                          },
                          {
                              "name": "created_by_id",
                              "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                              "source_column": "created_by_id"
                          },
                          {
                              "name": "last_modified_dt",
                              "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                              "source_column": "last_modified_dt"
                          },
                          {
                              "name": "last_modified_by_id",
                              "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                              "source_column": "last_modified_by_id"
                          },
                          {
                              "name": "portfolio_offer_id",
                              "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                              "source_column": "portfolio_offer_id"
                          },
                          {
                              "name": "discounted_priceable_unit_id",
                              "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                              "source_column": "discounted_priceable_unit_id"
                          },
                          {
                              "name": "effective_dt",
                              "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                              "source_column": "effective_dt"
                          },
                          {
                              "name": "end_dt",
                              "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                              "source_column": "end_dt"
                          },
                          {
                              "name": "quoted_discount",
                              "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                              "source_column": "quoted_discount"
                          }]
                      },
                      {
                          "sql": "sql/spine_offer_td_offer_discount_1.sql",
                          "destination_dataset_table": "",
                          "write_disposition": "WRITE_TRUNCATE",
                          "create_disposition": "CREATE_IF_NEEDED",
                          "allow_large_results": true,
                          "use_legacy_sql": false
                      },
                      {
                          "sql": "sql/spine_offer_td_offer_discount_2.sql",
                          "destination_dataset_table": "",
                          "write_disposition": "WRITE_TRUNCATE",
                          "create_disposition": "CREATE_IF_NEEDED",
                          "allow_large_results": true,
                          "use_legacy_sql": false
                      },
                      {
                          "sql": "sql/spine_offer_td_offer_discount_soip.sql",
                          "destination_dataset_table": "",
                          "write_disposition": "WRITE_TRUNCATE",
                          "create_disposition": "CREATE_IF_NEEDED",
                          "allow_large_results": true,
                          "use_legacy_sql": false
                      },
                      {
                          "sql": "sql/spine_offer_dim_offer_discount.sql",
                          "destination_dataset_table": "",
                          "write_disposition": "WRITE_TRUNCATE",
                          "create_disposition": "CREATE_IF_NEEDED",
                          "allow_large_results": true,
                          "use_legacy_sql": false
                      },
                      {
                          "sql": "sql/spine_offer_td_offer_status_soip.sql",
                          "destination_dataset_table": "",
                          "write_disposition": "WRITE_TRUNCATE",
                          "create_disposition": "CREATE_IF_NEEDED",
                          "allow_large_results": true,
                          "use_legacy_sql": false
                      },
                      {
                          "sql": "sql/spine_offer_dim_offer_status.sql",
                          "destination_dataset_table": "",
                          "write_disposition": "WRITE_TRUNCATE",
                          "create_disposition": "CREATE_IF_NEEDED",
                          "allow_large_results": true,
                          "use_legacy_sql": false
                      }]
                  },
                  "dependencies": {
                      "type": "array",
                      "title": "The dependencies Schema",
                      "items": {
                          "type": "string",
                          "title": "A Schema",
                          "examples": [
                              "td_offer_priceable_unit_soip",
                              "td_offer_priceable_unit_core",
                              "truncate_dim_offer_priceable_unit",
                              "td_offer_discount_core_pt1",
                              "td_offer_discount_core_pt2",
                              "td_offer_discount_soip",
                              "td_offer_status_core",
                              "td_offer_status_soip"
                          ]
                      },
                      "examples": [
                          [],
                          [],
                          [],
                          [],
                          ["td_offer_priceable_unit_soip",
                              "td_offer_priceable_unit_core"
                          ],
                          [
                              "truncate_dim_offer_priceable_unit"],
                          [
                              "truncate_dim_offer_priceable_unit"],
                          [],
                          [
                              "td_offer_discount_core_pt1"],
                          [],
                          ["td_offer_discount_core_pt2",
                              "td_offer_discount_soip"
                          ],
                          [],
                          ["td_offer_status_core",
                              "td_offer_status_soip"
                          ]
                      ]
                  }
              },
              "examples": [{
                  "task_id": "dim_offer_type",
                  "operator": "CreateTable",
                  "parameters": {
                      "destination_table": "dim_offer_type",
                      "target_type": 1,
                      "driving_table": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                      "joins": [{
                          "right": "uk_tds_refdata_eod_is.cc_refdata_bsboffertype",
                          "on": [{
                              "operator": "=",
                              "fields": [
                                  "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype.offertypeid",
                                  "uk_tds_refdata_eod_is.cc_refdata_bsboffertype.id"
                              ]
                          },
                          {
                              "operator": "\u003c\u003e",
                              "fields": [
                                  "uk_tds_refdata_eod_is.cc_refdata_bsboffertype.rdmaction",
                                  "'D'"
                              ]
                          }]
                      }],
                      "source_to_target": [{
                          "name": "id",
                          "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                          "source_column": "id"
                      },
                      {
                          "name": "dw_last_modified_dt",
                          "transformation": "current_timestamp()"
                      },
                      {
                          "name": "offer_detail_id",
                          "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                          "source_column": "offerid"
                      },
                      {
                          "name": "offer_type_id",
                          "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                          "source_column": "offertypeid"
                      },
                      {
                          "name": "offer_type_id",
                          "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                          "source_column": "offertypeid"
                      },
                      {
                          "name": "created_dt",
                          "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                          "source_column": "created"
                      },
                      {
                          "name": "created_by_id",
                          "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                          "source_column": "createdby"
                      },
                      {
                          "name": "last_modified_dt",
                          "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                          "source_column": "lastupdate"
                      },
                      {
                          "name": "last_modified_by_id",
                          "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                          "source_column": "updatedby"
                      },
                      {
                          "name": "code",
                          "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertype",
                          "source_column": "code"
                      },
                      {
                          "name": "description",
                          "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertype",
                          "source_column": "description"
                      }],
                      "where": [{
                          "operator": "\u003c\u003e",
                          "fields": [
                              "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype.offertypeid",
                              "'D'"
                          ]
                      }]
                  },
                  "dependencies": []
              },
              {
                  "task_id": "td_offer_status_core",
                  "operator": "CreateTable",
                  "parameters": {
                      "write_disposition": "WRITE_TRUNCATE",
                      "destination_table": "td_offer_status_core",
                      "destination_dataset": "uk_pre_customer_spine_offer_is",
                      "target_type": 2,
                      "history": {
                          "partition": [{
                              "name": "portfolio_offer_id",
                              "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                              "source_column": "id"
                          }],
                          "driving_column": [{
                              "name": "status_code",
                              "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                              "source_column": "status"
                          },
                          {
                              "name": "reason_code",
                              "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                              "source_column": "statusreasoncode"
                          }],
                          "order": [{
                              "name": "effective_from_dt",
                              "transformation": "ifnull(uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.statuschangeddate,uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.effective_from_dt)"
                          },
                          {
                              "name": "effective_from_dt_csn_seq",
                              "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                              "source_column": "effective_from_dt_csn_seq"
                          },
                          {
                              "name": "effective_from_dt_seq",
                              "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                              "source_column": "effective_from_dt_seq"
                          }]
                      },
                      "driving_table": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                      "joins": [{
                          "right": "uk_tds_chordiant_eod_is.cc_chordiant_picklist",
                          "on": [{
                              "operator": "=",
                              "fields": [
                                  "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.status",
                                  "uk_tds_chordiant_eod_is.cc_chordiant_picklist.code"
                              ]
                          },
                          {
                              "operator": "=",
                              "fields": [
                                  "uk_tds_chordiant_eod_is.cc_chordiant_picklist.logically_deleted",
                                  "0"
                              ]
                          }]
                      }],
                      "source_to_target": [{
                          "name": "portfolio_offer_id",
                          "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                          "source_column": "id"
                      },
                      {
                          "name": "dw_last_modified_dt",
                          "transformation": "current_timestamp()"
                      },
                      {
                          "name": "effective_from_dt",
                          "transformation": "ifnull(uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.statuschangeddate,uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.effective_from_dt)"
                      },
                      {
                          "name": "effective_from_dt_csn_seq",
                          "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                          "source_column": "effective_from_dt_csn_seq"
                      },
                      {
                          "name": "effective_from_dt_seq",
                          "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                          "source_column": "effective_from_dt_seq"
                      },
                      {
                          "name": "effective_to_dt",
                          "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                          "source_column": "statuschangeddate"
                      },
                      {
                          "name": "status_code",
                          "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                          "source_column": "status"
                      },
                      {
                          "name": "status",
                          "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_picklist",
                          "source_column": "codedesc"
                      },
                      {
                          "name": "reason_code",
                          "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                          "source_column": "statusreasoncode"
                      },
                      {
                          "name": "reason",
                          "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_picklist",
                          "source_column": "codedesc"
                      }],
                      "where": [{
                          "operator": "=",
                          "fields": [
                              "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.logically_deleted",
                              "0"
                          ]
                      }]
                  },
                  "dependencies": []
              },
              {
                  "task_id": "td_offer_priceable_unit_core",
                  "operator": "CreateTable",
                  "parameters": {
                      "write_disposition": "WRITE_TRUNCATE",
                      "destination_table": "td_offer_priceable_unit_core",
                      "destination_dataset": "uk_pre_customer_spine_offer_is",
                      "target_type": 1,
                      "driving_table": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                      "source_to_target": [{
                          "name": "id",
                          "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                          "source_column": "id"
                      },
                      {
                          "name": "dw_last_modified_dt",
                          "transformation": "current_timestamp()"
                      },
                      {
                          "name": "created_dt",
                          "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                          "source_column": "created"
                      },
                      {
                          "name": "created_by_id",
                          "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                          "source_column": "createdby"
                      },
                      {
                          "name": "last_modified_dt",
                          "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                          "source_column": "lastupdate"
                      },
                      {
                          "name": "last_modified_by_id",
                          "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                          "source_column": "updatedby"
                      },
                      {
                          "name": "portfolio_offer_id",
                          "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                          "source_column": "portfolioofferid"
                      },
                      {
                          "name": "discounted_priceable_unit_id",
                          "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                          "source_column": "discountedpriceableunitid"
                      },
                      {
                          "name": "effective_dt",
                          "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                          "source_column": "effectivedate"
                      },
                      {
                          "name": "end_dt",
                          "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                          "source_column": "endate"
                      },
                      {
                          "name": "quoted_discount",
                          "transformation": "abs(uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit.quotedprice)"
                      }],
                      "where": [{
                          "operator": "=",
                          "fields": [
                              "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit.logically_deleted",
                              "0"
                          ]
                      }]
                  },
                  "dependencies": []
              },
              {
                  "task_id": "td_offer_priceable_unit_soip",
                  "operator": "CreateTable",
                  "parameters": {
                      "sql": "sql/spine_offer_td_offer_priceable_unit_soip.sql",
                      "destination_table": "td_offer_priceable_unit_soip",
                      "destination_dataset": "uk_pre_customer_spine_offer_is"
                  },
                  "dependencies": []
              },
              {
                  "task_id": "truncate_dim_offer_priceable_unit",
                  "operator": "CreateTable",
                  "parameters": {
                      "sql": "truncate table uk_pub_customer_spine_offer_is.dim_offer_priceable_unit;",
                      "destination_table": "dim_offer_priceable_unit"
                  },
                  "dependencies": [
                      "td_offer_priceable_unit_soip",
                      "td_offer_priceable_unit_core"
                  ]
              },
              {
                  "task_id": "dim_offer_priceable_unit_core",
                  "operator": "CreateTable",
                  "parameters": {
                      "write_disposition": "WRITE_APPEND",
                      "destination_table": "dim_offer_priceable_unit",
                      "target_type": 1,
                      "driving_table": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                      "source_to_target": [{
                          "name": "id",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                          "source_column": "id"
                      },
                      {
                          "name": "dw_last_modified_dt",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                          "source_column": "dw_last_modified_dt"
                      },
                      {
                          "name": "created_dt",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                          "source_column": "created_dt"
                      },
                      {
                          "name": "created_by_id",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                          "source_column": "created_by_id"
                      },
                      {
                          "name": "last_modified_dt",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                          "source_column": "last_modified_dt"
                      },
                      {
                          "name": "last_modified_by_id",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                          "source_column": "last_modified_by_id"
                      },
                      {
                          "name": "portfolio_offer_id",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                          "source_column": "portfolio_offer_id"
                      },
                      {
                          "name": "discounted_priceable_unit_id",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                          "source_column": "discounted_priceable_unit_id"
                      },
                      {
                          "name": "effective_dt",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                          "source_column": "effective_dt"
                      },
                      {
                          "name": "end_dt",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                          "source_column": "end_dt"
                      },
                      {
                          "name": "quoted_discount",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                          "source_column": "quoted_discount"
                      }]
                  },
                  "dependencies": [
                      "truncate_dim_offer_priceable_unit"
                  ]
              },
              {
                  "task_id": "dim_offer_priceable_unit_soip",
                  "operator": "CreateTable",
                  "parameters": {
                      "write_disposition": "WRITE_APPEND",
                      "destination_table": "dim_offer_priceable_unit",
                      "target_type": 1,
                      "driving_table": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                      "source_to_target": [{
                          "name": "id",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                          "source_column": "id"
                      },
                      {
                          "name": "dw_last_modified_dt",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                          "source_column": "dw_last_modified_dt"
                      },
                      {
                          "name": "created_dt",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                          "source_column": "created_dt"
                      },
                      {
                          "name": "created_by_id",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                          "source_column": "created_by_id"
                      },
                      {
                          "name": "last_modified_dt",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                          "source_column": "last_modified_dt"
                      },
                      {
                          "name": "last_modified_by_id",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                          "source_column": "last_modified_by_id"
                      },
                      {
                          "name": "portfolio_offer_id",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                          "source_column": "portfolio_offer_id"
                      },
                      {
                          "name": "discounted_priceable_unit_id",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                          "source_column": "discounted_priceable_unit_id"
                      },
                      {
                          "name": "effective_dt",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                          "source_column": "effective_dt"
                      },
                      {
                          "name": "end_dt",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                          "source_column": "end_dt"
                      },
                      {
                          "name": "quoted_discount",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                          "source_column": "quoted_discount"
                      }]
                  },
                  "dependencies": [
                      "truncate_dim_offer_priceable_unit"
                  ]
              },
              {
                  "task_id": "td_offer_discount_core_pt1",
                  "operator": "BigQueryOperator",
                  "parameters": {
                      "sql": "sql/spine_offer_td_offer_discount_1.sql",
                      "destination_dataset_table": "",
                      "write_disposition": "WRITE_TRUNCATE",
                      "create_disposition": "CREATE_IF_NEEDED",
                      "allow_large_results": true,
                      "use_legacy_sql": false
                  },
                  "dependencies": []
              },
              {
                  "task_id": "td_offer_discount_core_pt2",
                  "operator": "BigQueryOperator",
                  "parameters": {
                      "sql": "sql/spine_offer_td_offer_discount_2.sql",
                      "destination_dataset_table": "",
                      "write_disposition": "WRITE_TRUNCATE",
                      "create_disposition": "CREATE_IF_NEEDED",
                      "allow_large_results": true,
                      "use_legacy_sql": false
                  },
                  "dependencies": [
                      "td_offer_discount_core_pt1"
                  ]
              },
              {
                  "task_id": "td_offer_discount_soip",
                  "operator": "BigQueryOperator",
                  "parameters": {
                      "sql": "sql/spine_offer_td_offer_discount_soip.sql",
                      "destination_dataset_table": "",
                      "write_disposition": "WRITE_TRUNCATE",
                      "create_disposition": "CREATE_IF_NEEDED",
                      "allow_large_results": true,
                      "use_legacy_sql": false
                  },
                  "dependencies": []
              },
              {
                  "task_id": "dim_offer_discount",
                  "operator": "BigQueryOperator",
                  "parameters": {
                      "sql": "sql/spine_offer_dim_offer_discount.sql",
                      "destination_dataset_table": "",
                      "write_disposition": "WRITE_TRUNCATE",
                      "create_disposition": "CREATE_IF_NEEDED",
                      "allow_large_results": true,
                      "use_legacy_sql": false
                  },
                  "dependencies": [
                      "td_offer_discount_core_pt2",
                      "td_offer_discount_soip"
                  ]
              },
              {
                  "task_id": "td_offer_status_soip",
                  "operator": "BigQueryOperator",
                  "parameters": {
                      "sql": "sql/spine_offer_td_offer_status_soip.sql",
                      "destination_dataset_table": "",
                      "write_disposition": "WRITE_TRUNCATE",
                      "create_disposition": "CREATE_IF_NEEDED",
                      "allow_large_results": true,
                      "use_legacy_sql": false
                  },
                  "dependencies": []
              },
              {
                  "task_id": "dim_offer_status",
                  "operator": "BigQueryOperator",
                  "parameters": {
                      "sql": "sql/spine_offer_dim_offer_status.sql",
                      "destination_dataset_table": "",
                      "write_disposition": "WRITE_TRUNCATE",
                      "create_disposition": "CREATE_IF_NEEDED",
                      "allow_large_results": true,
                      "use_legacy_sql": false
                  },
                  "dependencies": [
                      "td_offer_status_core",
                      "td_offer_status_soip"
                  ]
              }]
          },
          "examples": [
              [{
                  "task_id": "dim_offer_type",
                  "operator": "CreateTable",
                  "parameters": {
                      "destination_table": "dim_offer_type",
                      "target_type": 1,
                      "driving_table": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                      "joins": [{
                          "right": "uk_tds_refdata_eod_is.cc_refdata_bsboffertype",
                          "on": [{
                              "operator": "=",
                              "fields": [
                                  "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype.offertypeid",
                                  "uk_tds_refdata_eod_is.cc_refdata_bsboffertype.id"
                              ]
                          },
                          {
                              "operator": "\u003c\u003e",
                              "fields": [
                                  "uk_tds_refdata_eod_is.cc_refdata_bsboffertype.rdmaction",
                                  "'D'"
                              ]
                          }]
                      }],
                      "source_to_target": [{
                          "name": "id",
                          "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                          "source_column": "id"
                      },
                      {
                          "name": "dw_last_modified_dt",
                          "transformation": "current_timestamp()"
                      },
                      {
                          "name": "offer_detail_id",
                          "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                          "source_column": "offerid"
                      },
                      {
                          "name": "offer_type_id",
                          "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                          "source_column": "offertypeid"
                      },
                      {
                          "name": "offer_type_id",
                          "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                          "source_column": "offertypeid"
                      },
                      {
                          "name": "created_dt",
                          "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                          "source_column": "created"
                      },
                      {
                          "name": "created_by_id",
                          "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                          "source_column": "createdby"
                      },
                      {
                          "name": "last_modified_dt",
                          "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                          "source_column": "lastupdate"
                      },
                      {
                          "name": "last_modified_by_id",
                          "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                          "source_column": "updatedby"
                      },
                      {
                          "name": "code",
                          "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertype",
                          "source_column": "code"
                      },
                      {
                          "name": "description",
                          "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertype",
                          "source_column": "description"
                      }],
                      "where": [{
                          "operator": "\u003c\u003e",
                          "fields": [
                              "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype.offertypeid",
                              "'D'"
                          ]
                      }]
                  },
                  "dependencies": []
              },
              {
                  "task_id": "td_offer_status_core",
                  "operator": "CreateTable",
                  "parameters": {
                      "write_disposition": "WRITE_TRUNCATE",
                      "destination_table": "td_offer_status_core",
                      "destination_dataset": "uk_pre_customer_spine_offer_is",
                      "target_type": 2,
                      "history": {
                          "partition": [{
                              "name": "portfolio_offer_id",
                              "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                              "source_column": "id"
                          }],
                          "driving_column": [{
                              "name": "status_code",
                              "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                              "source_column": "status"
                          },
                          {
                              "name": "reason_code",
                              "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                              "source_column": "statusreasoncode"
                          }],
                          "order": [{
                              "name": "effective_from_dt",
                              "transformation": "ifnull(uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.statuschangeddate,uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.effective_from_dt)"
                          },
                          {
                              "name": "effective_from_dt_csn_seq",
                              "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                              "source_column": "effective_from_dt_csn_seq"
                          },
                          {
                              "name": "effective_from_dt_seq",
                              "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                              "source_column": "effective_from_dt_seq"
                          }]
                      },
                      "driving_table": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                      "joins": [{
                          "right": "uk_tds_chordiant_eod_is.cc_chordiant_picklist",
                          "on": [{
                              "operator": "=",
                              "fields": [
                                  "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.status",
                                  "uk_tds_chordiant_eod_is.cc_chordiant_picklist.code"
                              ]
                          },
                          {
                              "operator": "=",
                              "fields": [
                                  "uk_tds_chordiant_eod_is.cc_chordiant_picklist.logically_deleted",
                                  "0"
                              ]
                          }]
                      }],
                      "source_to_target": [{
                          "name": "portfolio_offer_id",
                          "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                          "source_column": "id"
                      },
                      {
                          "name": "dw_last_modified_dt",
                          "transformation": "current_timestamp()"
                      },
                      {
                          "name": "effective_from_dt",
                          "transformation": "ifnull(uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.statuschangeddate,uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.effective_from_dt)"
                      },
                      {
                          "name": "effective_from_dt_csn_seq",
                          "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                          "source_column": "effective_from_dt_csn_seq"
                      },
                      {
                          "name": "effective_from_dt_seq",
                          "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                          "source_column": "effective_from_dt_seq"
                      },
                      {
                          "name": "effective_to_dt",
                          "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                          "source_column": "statuschangeddate"
                      },
                      {
                          "name": "status_code",
                          "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                          "source_column": "status"
                      },
                      {
                          "name": "status",
                          "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_picklist",
                          "source_column": "codedesc"
                      },
                      {
                          "name": "reason_code",
                          "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                          "source_column": "statusreasoncode"
                      },
                      {
                          "name": "reason",
                          "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_picklist",
                          "source_column": "codedesc"
                      }],
                      "where": [{
                          "operator": "=",
                          "fields": [
                              "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.logically_deleted",
                              "0"
                          ]
                      }]
                  },
                  "dependencies": []
              },
              {
                  "task_id": "td_offer_priceable_unit_core",
                  "operator": "CreateTable",
                  "parameters": {
                      "write_disposition": "WRITE_TRUNCATE",
                      "destination_table": "td_offer_priceable_unit_core",
                      "destination_dataset": "uk_pre_customer_spine_offer_is",
                      "target_type": 1,
                      "driving_table": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                      "source_to_target": [{
                          "name": "id",
                          "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                          "source_column": "id"
                      },
                      {
                          "name": "dw_last_modified_dt",
                          "transformation": "current_timestamp()"
                      },
                      {
                          "name": "created_dt",
                          "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                          "source_column": "created"
                      },
                      {
                          "name": "created_by_id",
                          "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                          "source_column": "createdby"
                      },
                      {
                          "name": "last_modified_dt",
                          "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                          "source_column": "lastupdate"
                      },
                      {
                          "name": "last_modified_by_id",
                          "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                          "source_column": "updatedby"
                      },
                      {
                          "name": "portfolio_offer_id",
                          "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                          "source_column": "portfolioofferid"
                      },
                      {
                          "name": "discounted_priceable_unit_id",
                          "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                          "source_column": "discountedpriceableunitid"
                      },
                      {
                          "name": "effective_dt",
                          "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                          "source_column": "effectivedate"
                      },
                      {
                          "name": "end_dt",
                          "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                          "source_column": "endate"
                      },
                      {
                          "name": "quoted_discount",
                          "transformation": "abs(uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit.quotedprice)"
                      }],
                      "where": [{
                          "operator": "=",
                          "fields": [
                              "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit.logically_deleted",
                              "0"
                          ]
                      }]
                  },
                  "dependencies": []
              },
              {
                  "task_id": "td_offer_priceable_unit_soip",
                  "operator": "CreateTable",
                  "parameters": {
                      "sql": "sql/spine_offer_td_offer_priceable_unit_soip.sql",
                      "destination_table": "td_offer_priceable_unit_soip",
                      "destination_dataset": "uk_pre_customer_spine_offer_is"
                  },
                  "dependencies": []
              },
              {
                  "task_id": "truncate_dim_offer_priceable_unit",
                  "operator": "CreateTable",
                  "parameters": {
                      "sql": "truncate table uk_pub_customer_spine_offer_is.dim_offer_priceable_unit;",
                      "destination_table": "dim_offer_priceable_unit"
                  },
                  "dependencies": [
                      "td_offer_priceable_unit_soip",
                      "td_offer_priceable_unit_core"
                  ]
              },
              {
                  "task_id": "dim_offer_priceable_unit_core",
                  "operator": "CreateTable",
                  "parameters": {
                      "write_disposition": "WRITE_APPEND",
                      "destination_table": "dim_offer_priceable_unit",
                      "target_type": 1,
                      "driving_table": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                      "source_to_target": [{
                          "name": "id",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                          "source_column": "id"
                      },
                      {
                          "name": "dw_last_modified_dt",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                          "source_column": "dw_last_modified_dt"
                      },
                      {
                          "name": "created_dt",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                          "source_column": "created_dt"
                      },
                      {
                          "name": "created_by_id",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                          "source_column": "created_by_id"
                      },
                      {
                          "name": "last_modified_dt",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                          "source_column": "last_modified_dt"
                      },
                      {
                          "name": "last_modified_by_id",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                          "source_column": "last_modified_by_id"
                      },
                      {
                          "name": "portfolio_offer_id",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                          "source_column": "portfolio_offer_id"
                      },
                      {
                          "name": "discounted_priceable_unit_id",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                          "source_column": "discounted_priceable_unit_id"
                      },
                      {
                          "name": "effective_dt",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                          "source_column": "effective_dt"
                      },
                      {
                          "name": "end_dt",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                          "source_column": "end_dt"
                      },
                      {
                          "name": "quoted_discount",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                          "source_column": "quoted_discount"
                      }]
                  },
                  "dependencies": [
                      "truncate_dim_offer_priceable_unit"
                  ]
              },
              {
                  "task_id": "dim_offer_priceable_unit_soip",
                  "operator": "CreateTable",
                  "parameters": {
                      "write_disposition": "WRITE_APPEND",
                      "destination_table": "dim_offer_priceable_unit",
                      "target_type": 1,
                      "driving_table": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                      "source_to_target": [{
                          "name": "id",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                          "source_column": "id"
                      },
                      {
                          "name": "dw_last_modified_dt",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                          "source_column": "dw_last_modified_dt"
                      },
                      {
                          "name": "created_dt",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                          "source_column": "created_dt"
                      },
                      {
                          "name": "created_by_id",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                          "source_column": "created_by_id"
                      },
                      {
                          "name": "last_modified_dt",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                          "source_column": "last_modified_dt"
                      },
                      {
                          "name": "last_modified_by_id",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                          "source_column": "last_modified_by_id"
                      },
                      {
                          "name": "portfolio_offer_id",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                          "source_column": "portfolio_offer_id"
                      },
                      {
                          "name": "discounted_priceable_unit_id",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                          "source_column": "discounted_priceable_unit_id"
                      },
                      {
                          "name": "effective_dt",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                          "source_column": "effective_dt"
                      },
                      {
                          "name": "end_dt",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                          "source_column": "end_dt"
                      },
                      {
                          "name": "quoted_discount",
                          "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                          "source_column": "quoted_discount"
                      }]
                  },
                  "dependencies": [
                      "truncate_dim_offer_priceable_unit"
                  ]
              },
              {
                  "task_id": "td_offer_discount_core_pt1",
                  "operator": "BigQueryOperator",
                  "parameters": {
                      "sql": "sql/spine_offer_td_offer_discount_1.sql",
                      "destination_dataset_table": "",
                      "write_disposition": "WRITE_TRUNCATE",
                      "create_disposition": "CREATE_IF_NEEDED",
                      "allow_large_results": true,
                      "use_legacy_sql": false
                  },
                  "dependencies": []
              },
              {
                  "task_id": "td_offer_discount_core_pt2",
                  "operator": "BigQueryOperator",
                  "parameters": {
                      "sql": "sql/spine_offer_td_offer_discount_2.sql",
                      "destination_dataset_table": "",
                      "write_disposition": "WRITE_TRUNCATE",
                      "create_disposition": "CREATE_IF_NEEDED",
                      "allow_large_results": true,
                      "use_legacy_sql": false
                  },
                  "dependencies": [
                      "td_offer_discount_core_pt1"
                  ]
              },
              {
                  "task_id": "td_offer_discount_soip",
                  "operator": "BigQueryOperator",
                  "parameters": {
                      "sql": "sql/spine_offer_td_offer_discount_soip.sql",
                      "destination_dataset_table": "",
                      "write_disposition": "WRITE_TRUNCATE",
                      "create_disposition": "CREATE_IF_NEEDED",
                      "allow_large_results": true,
                      "use_legacy_sql": false
                  },
                  "dependencies": []
              },
              {
                  "task_id": "dim_offer_discount",
                  "operator": "BigQueryOperator",
                  "parameters": {
                      "sql": "sql/spine_offer_dim_offer_discount.sql",
                      "destination_dataset_table": "",
                      "write_disposition": "WRITE_TRUNCATE",
                      "create_disposition": "CREATE_IF_NEEDED",
                      "allow_large_results": true,
                      "use_legacy_sql": false
                  },
                  "dependencies": [
                      "td_offer_discount_core_pt2",
                      "td_offer_discount_soip"
                  ]
              },
              {
                  "task_id": "td_offer_status_soip",
                  "operator": "BigQueryOperator",
                  "parameters": {
                      "sql": "sql/spine_offer_td_offer_status_soip.sql",
                      "destination_dataset_table": "",
                      "write_disposition": "WRITE_TRUNCATE",
                      "create_disposition": "CREATE_IF_NEEDED",
                      "allow_large_results": true,
                      "use_legacy_sql": false
                  },
                  "dependencies": []
              },
              {
                  "task_id": "dim_offer_status",
                  "operator": "BigQueryOperator",
                  "parameters": {
                      "sql": "sql/spine_offer_dim_offer_status.sql",
                      "destination_dataset_table": "",
                      "write_disposition": "WRITE_TRUNCATE",
                      "create_disposition": "CREATE_IF_NEEDED",
                      "allow_large_results": true,
                      "use_legacy_sql": false
                  },
                  "dependencies": [
                      "td_offer_status_core",
                      "td_offer_status_soip"
                  ]
              }]
          ]
      }
  },
  "examples": [{
      "name": "GCP_SPINE_OFFER",
      "dag": {
          "description": "Populates portfolio offer tables uk_pub_customer_spine_offer_is",
          "tags": [
              "offer",
              "customer"
          ]
      },
      "args": {
          "owner": "customerbtprod",
          "email": [
              "sean.conkie@sky.uk"
          ]
      },
      "properties": {
          "dataset_staging": "uk_pre_customer_spine_offer_is",
          "dataset_publish": "uk_pub_customer_spine_offer_is"
      },
      "imports": [],
      "tasks": [{
          "task_id": "dim_offer_type",
          "operator": "CreateTable",
          "parameters": {
              "destination_table": "dim_offer_type",
              "target_type": 1,
              "driving_table": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
              "joins": [{
                  "right": "uk_tds_refdata_eod_is.cc_refdata_bsboffertype",
                  "on": [{
                      "operator": "=",
                      "fields": [
                          "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype.offertypeid",
                          "uk_tds_refdata_eod_is.cc_refdata_bsboffertype.id"
                      ]
                  },
                  {
                      "operator": "\u003c\u003e",
                      "fields": [
                          "uk_tds_refdata_eod_is.cc_refdata_bsboffertype.rdmaction",
                          "'D'"
                      ]
                  }]
              }],
              "source_to_target": [{
                  "name": "id",
                  "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                  "source_column": "id"
              },
              {
                  "name": "dw_last_modified_dt",
                  "transformation": "current_timestamp()"
              },
              {
                  "name": "offer_detail_id",
                  "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                  "source_column": "offerid"
              },
              {
                  "name": "offer_type_id",
                  "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                  "source_column": "offertypeid"
              },
              {
                  "name": "offer_type_id",
                  "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                  "source_column": "offertypeid"
              },
              {
                  "name": "created_dt",
                  "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                  "source_column": "created"
              },
              {
                  "name": "created_by_id",
                  "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                  "source_column": "createdby"
              },
              {
                  "name": "last_modified_dt",
                  "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                  "source_column": "lastupdate"
              },
              {
                  "name": "last_modified_by_id",
                  "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype",
                  "source_column": "updatedby"
              },
              {
                  "name": "code",
                  "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertype",
                  "source_column": "code"
              },
              {
                  "name": "description",
                  "source_name": "uk_tds_refdata_eod_is.cc_refdata_bsboffertype",
                  "source_column": "description"
              }],
              "where": [{
                  "operator": "\u003c\u003e",
                  "fields": [
                      "uk_tds_refdata_eod_is.cc_refdata_bsboffertooffertype.offertypeid",
                      "'D'"
                  ]
              }]
          },
          "dependencies": []
      },
      {
          "task_id": "td_offer_status_core",
          "operator": "CreateTable",
          "parameters": {
              "write_disposition": "WRITE_TRUNCATE",
              "destination_table": "td_offer_status_core",
              "destination_dataset": "uk_pre_customer_spine_offer_is",
              "target_type": 2,
              "history": {
                  "partition": [{
                      "name": "portfolio_offer_id",
                      "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                      "source_column": "id"
                  }],
                  "driving_column": [{
                      "name": "status_code",
                      "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                      "source_column": "status"
                  },
                  {
                      "name": "reason_code",
                      "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                      "source_column": "statusreasoncode"
                  }],
                  "order": [{
                      "name": "effective_from_dt",
                      "transformation": "ifnull(uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.statuschangeddate,uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.effective_from_dt)"
                  },
                  {
                      "name": "effective_from_dt_csn_seq",
                      "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                      "source_column": "effective_from_dt_csn_seq"
                  },
                  {
                      "name": "effective_from_dt_seq",
                      "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                      "source_column": "effective_from_dt_seq"
                  }]
              },
              "driving_table": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
              "joins": [{
                  "right": "uk_tds_chordiant_eod_is.cc_chordiant_picklist",
                  "on": [{
                      "operator": "=",
                      "fields": [
                          "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.status",
                          "uk_tds_chordiant_eod_is.cc_chordiant_picklist.code"
                      ]
                  },
                  {
                      "operator": "=",
                      "fields": [
                          "uk_tds_chordiant_eod_is.cc_chordiant_picklist.logically_deleted",
                          "0"
                      ]
                  }]
              }],
              "source_to_target": [{
                  "name": "portfolio_offer_id",
                  "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                  "source_column": "id"
              },
              {
                  "name": "dw_last_modified_dt",
                  "transformation": "current_timestamp()"
              },
              {
                  "name": "effective_from_dt",
                  "transformation": "ifnull(uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.statuschangeddate,uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.effective_from_dt)"
              },
              {
                  "name": "effective_from_dt_csn_seq",
                  "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                  "source_column": "effective_from_dt_csn_seq"
              },
              {
                  "name": "effective_from_dt_seq",
                  "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                  "source_column": "effective_from_dt_seq"
              },
              {
                  "name": "effective_to_dt",
                  "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                  "source_column": "statuschangeddate"
              },
              {
                  "name": "status_code",
                  "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                  "source_column": "status"
              },
              {
                  "name": "status",
                  "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_picklist",
                  "source_column": "codedesc"
              },
              {
                  "name": "reason_code",
                  "source_name": "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer",
                  "source_column": "statusreasoncode"
              },
              {
                  "name": "reason",
                  "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_picklist",
                  "source_column": "codedesc"
              }],
              "where": [{
                  "operator": "=",
                  "fields": [
                      "uk_tds_chordiant_eod_fc_is.fc_chordiant_bsbportfoliooffer.logically_deleted",
                      "0"
                  ]
              }]
          },
          "dependencies": []
      },
      {
          "task_id": "td_offer_priceable_unit_core",
          "operator": "CreateTable",
          "parameters": {
              "write_disposition": "WRITE_TRUNCATE",
              "destination_table": "td_offer_priceable_unit_core",
              "destination_dataset": "uk_pre_customer_spine_offer_is",
              "target_type": 1,
              "driving_table": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
              "source_to_target": [{
                  "name": "id",
                  "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                  "source_column": "id"
              },
              {
                  "name": "dw_last_modified_dt",
                  "transformation": "current_timestamp()"
              },
              {
                  "name": "created_dt",
                  "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                  "source_column": "created"
              },
              {
                  "name": "created_by_id",
                  "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                  "source_column": "createdby"
              },
              {
                  "name": "last_modified_dt",
                  "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                  "source_column": "lastupdate"
              },
              {
                  "name": "last_modified_by_id",
                  "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                  "source_column": "updatedby"
              },
              {
                  "name": "portfolio_offer_id",
                  "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                  "source_column": "portfolioofferid"
              },
              {
                  "name": "discounted_priceable_unit_id",
                  "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                  "source_column": "discountedpriceableunitid"
              },
              {
                  "name": "effective_dt",
                  "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                  "source_column": "effectivedate"
              },
              {
                  "name": "end_dt",
                  "source_name": "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit",
                  "source_column": "endate"
              },
              {
                  "name": "quoted_discount",
                  "transformation": "abs(uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit.quotedprice)"
              }],
              "where": [{
                  "operator": "=",
                  "fields": [
                      "uk_tds_chordiant_eod_is.cc_chordiant_bsbpriceableunit.logically_deleted",
                      "0"
                  ]
              }]
          },
          "dependencies": []
      },
      {
          "task_id": "td_offer_priceable_unit_soip",
          "operator": "CreateTable",
          "parameters": {
              "sql": "sql/spine_offer_td_offer_priceable_unit_soip.sql",
              "destination_table": "td_offer_priceable_unit_soip",
              "destination_dataset": "uk_pre_customer_spine_offer_is"
          },
          "dependencies": []
      },
      {
          "task_id": "truncate_dim_offer_priceable_unit",
          "operator": "CreateTable",
          "parameters": {
              "sql": "truncate table uk_pub_customer_spine_offer_is.dim_offer_priceable_unit;",
              "destination_table": "dim_offer_priceable_unit"
          },
          "dependencies": [
              "td_offer_priceable_unit_soip",
              "td_offer_priceable_unit_core"
          ]
      },
      {
          "task_id": "dim_offer_priceable_unit_core",
          "operator": "CreateTable",
          "parameters": {
              "write_disposition": "WRITE_APPEND",
              "destination_table": "dim_offer_priceable_unit",
              "target_type": 1,
              "driving_table": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
              "source_to_target": [{
                  "name": "id",
                  "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                  "source_column": "id"
              },
              {
                  "name": "dw_last_modified_dt",
                  "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                  "source_column": "dw_last_modified_dt"
              },
              {
                  "name": "created_dt",
                  "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                  "source_column": "created_dt"
              },
              {
                  "name": "created_by_id",
                  "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                  "source_column": "created_by_id"
              },
              {
                  "name": "last_modified_dt",
                  "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                  "source_column": "last_modified_dt"
              },
              {
                  "name": "last_modified_by_id",
                  "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                  "source_column": "last_modified_by_id"
              },
              {
                  "name": "portfolio_offer_id",
                  "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                  "source_column": "portfolio_offer_id"
              },
              {
                  "name": "discounted_priceable_unit_id",
                  "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                  "source_column": "discounted_priceable_unit_id"
              },
              {
                  "name": "effective_dt",
                  "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                  "source_column": "effective_dt"
              },
              {
                  "name": "end_dt",
                  "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                  "source_column": "end_dt"
              },
              {
                  "name": "quoted_discount",
                  "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_core",
                  "source_column": "quoted_discount"
              }]
          },
          "dependencies": [
              "truncate_dim_offer_priceable_unit"
          ]
      },
      {
          "task_id": "dim_offer_priceable_unit_soip",
          "operator": "CreateTable",
          "parameters": {
              "write_disposition": "WRITE_APPEND",
              "destination_table": "dim_offer_priceable_unit",
              "target_type": 1,
              "driving_table": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
              "source_to_target": [{
                  "name": "id",
                  "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                  "source_column": "id"
              },
              {
                  "name": "dw_last_modified_dt",
                  "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                  "source_column": "dw_last_modified_dt"
              },
              {
                  "name": "created_dt",
                  "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                  "source_column": "created_dt"
              },
              {
                  "name": "created_by_id",
                  "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                  "source_column": "created_by_id"
              },
              {
                  "name": "last_modified_dt",
                  "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                  "source_column": "last_modified_dt"
              },
              {
                  "name": "last_modified_by_id",
                  "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                  "source_column": "last_modified_by_id"
              },
              {
                  "name": "portfolio_offer_id",
                  "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                  "source_column": "portfolio_offer_id"
              },
              {
                  "name": "discounted_priceable_unit_id",
                  "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                  "source_column": "discounted_priceable_unit_id"
              },
              {
                  "name": "effective_dt",
                  "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                  "source_column": "effective_dt"
              },
              {
                  "name": "end_dt",
                  "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                  "source_column": "end_dt"
              },
              {
                  "name": "quoted_discount",
                  "source_name": "uk_pre_customer_spine_offer_is.td_offer_priceable_unit_soip",
                  "source_column": "quoted_discount"
              }]
          },
          "dependencies": [
              "truncate_dim_offer_priceable_unit"
          ]
      },
      {
          "task_id": "td_offer_discount_core_pt1",
          "operator": "BigQueryOperator",
          "parameters": {
              "sql": "sql/spine_offer_td_offer_discount_1.sql",
              "destination_dataset_table": "",
              "write_disposition": "WRITE_TRUNCATE",
              "create_disposition": "CREATE_IF_NEEDED",
              "allow_large_results": true,
              "use_legacy_sql": false
          },
          "dependencies": []
      },
      {
          "task_id": "td_offer_discount_core_pt2",
          "operator": "BigQueryOperator",
          "parameters": {
              "sql": "sql/spine_offer_td_offer_discount_2.sql",
              "destination_dataset_table": "",
              "write_disposition": "WRITE_TRUNCATE",
              "create_disposition": "CREATE_IF_NEEDED",
              "allow_large_results": true,
              "use_legacy_sql": false
          },
          "dependencies": [
              "td_offer_discount_core_pt1"
          ]
      },
      {
          "task_id": "td_offer_discount_soip",
          "operator": "BigQueryOperator",
          "parameters": {
              "sql": "sql/spine_offer_td_offer_discount_soip.sql",
              "destination_dataset_table": "",
              "write_disposition": "WRITE_TRUNCATE",
              "create_disposition": "CREATE_IF_NEEDED",
              "allow_large_results": true,
              "use_legacy_sql": false
          },
          "dependencies": []
      },
      {
          "task_id": "dim_offer_discount",
          "operator": "BigQueryOperator",
          "parameters": {
              "sql": "sql/spine_offer_dim_offer_discount.sql",
              "destination_dataset_table": "",
              "write_disposition": "WRITE_TRUNCATE",
              "create_disposition": "CREATE_IF_NEEDED",
              "allow_large_results": true,
              "use_legacy_sql": false
          },
          "dependencies": [
              "td_offer_discount_core_pt2",
              "td_offer_discount_soip"
          ]
      },
      {
          "task_id": "td_offer_status_soip",
          "operator": "BigQueryOperator",
          "parameters": {
              "sql": "sql/spine_offer_td_offer_status_soip.sql",
              "destination_dataset_table": "",
              "write_disposition": "WRITE_TRUNCATE",
              "create_disposition": "CREATE_IF_NEEDED",
              "allow_large_results": true,
              "use_legacy_sql": false
          },
          "dependencies": []
      },
      {
          "task_id": "dim_offer_status",
          "operator": "BigQueryOperator",
          "parameters": {
              "sql": "sql/spine_offer_dim_offer_status.sql",
              "destination_dataset_table": "",
              "write_disposition": "WRITE_TRUNCATE",
              "create_disposition": "CREATE_IF_NEEDED",
              "allow_large_results": true,
              "use_legacy_sql": false
          },
          "dependencies": [
              "td_offer_status_core",
              "td_offer_status_soip"
          ]
      }]
  }]
}